class GeoItem{constructor(n,t,i,r,u,f,e){this.country=n;this.region=t;this.postal=i;this.city=r;this.organization=u;this.latitude=f;this.longitude=e}}class Exc{constructor(n,t){this.extype=n;this.message=t}}class GetItems{setResult(n){$(document).ready(()=>{let t=$(".mainblock1"),i=$(".resultTab");t.hide();i.html("");$.get(n,n=>{let r=n;if(r==null||r===undefined){notification.error("Null object accepted",7e3);return}if(r.error!=null){r.error.extype.indexOf("KeyNotFoundException")!=-1?notification.info(r.error.message,7e3):notification.error(r.error.message,7e3);return}if(r.gi!=null){t.show();i.html(this.getGiHTML(r.gi));return}if(r.items!=null){let n;for(let t of r.items)n=`${n}${this.getGiHTML(t)}`;t.show();i.html(n);return}console.log(n)})})}getGiHTML(n){return`<tr><td><dl class="row">
<dt class="col-sm-3">Country</dt><dd class="col-sm-9">${n.country}</dd>
<dt class="col-sm-3">Region</dt><dd class="col-sm-9">${n.region}</dd>
<dt class="col-sm-3">Postal</dt><dd class="col-sm-9">${n.postal}</dd>
<dt class="col-sm-3">City</dt><dd class="col-sm-9">${n.city}</dd>
<dt class="col-sm-3">Organization</dt><dd class="col-sm-9">${n.organization}</dd>
<dt class="col-sm-3">Latitude</dt><dd class="col-sm-9">${n.latitude.toString()}</dd>
<dt class="col-sm-3">Longitute</dt><dd class="col-sm-9">${n.longitude.toString()}</dd>
</dl></td></tr>`}}class OperationResult{constructor(n,t,i){this.gi=n;this.items=t;this.error=i}}class PageBase{constructor(n,t,i,r,u,f){var c,p;this.validator=u;this.mustextract=f;let o;this._historytitle=r;let e=window.location.href,h=e.lastIndexOf("#");if(this._urlpostfix=e.substr(h+1).trim(),f){let n=e.indexOf("?");if(n!=-1&&(n=e.indexOf("=",n+1),n!=-1)){let t=h-n;t>0&&(o=e.substr(n+1,t-1))}}let s=n.indexOf("?"),l=n.indexOf("=",s+1),a=l-s;this._urlparamname=n.substr(s+1,a);let v=$(".resultTab"),y=$(".mainblock1");v.html("");y.hide();c=$(".searchlabel");this._inputField=$(".searchinput");this._inputField.val("");this._validationText=$(".validationmess");this._searchButton=$(".searchbutton");this._searchButton.prop("disabled",!0);this._searchButton.off("click");this._searchButton.on("click",n=>this.StartSearch(n));this._inputField.off("keyup");this._inputField.on("keyup",n=>this.ValidationFunc(n));this._getItems==null&&(this._getItems=new GetItems);this._urlfirst=n;this._inputField.attr({placeholder:t});c.html(i);o!=null&&(this._inputField.val(o),p=this._inputField.keypress(),this._searchButton.prop("disabled")==!1&&this._searchButton.click(),this._searchButton.click());this.clearValidationText()}StartSearch(n){n.stopPropagation();this._inputField.keyup();let t=this._validationText.html(),i=$(n.target);if(i.prop("disabled",!0),t==null||t==""){let r=this._inputField.val().toString().trim();this._getItems.setResult(this._urlfirst+r);i.prop("disabled",!1);let u="?"+this._urlparamname+r+"#"+this._urlpostfix;window.history.pushState(null,this._historytitle,u)}}ValidationFunc(n){n.stopPropagation();let i=$(n.target),t=this.validator(i.val().toString().trim());t!=null?this.showValidationText(t):this.clearValidationText()}addErrorToIF(){this._inputField.hasClass("is-invalid")||this._inputField.addClass("is-invalid")}removeErrorFromIF(){this._inputField.hasClass("is-invalid")&&this._inputField.removeClass("is-invalid")}showValidationText(n){this._validationText.html(n);this.addErrorToIF();this._searchButton.prop("disabled",!0)}clearValidationText(){this._validationText.html("");this.removeErrorFromIF();this._searchButton.prop("disabled",!1)}}var forCitySearch=n=>{let i="Required field";if(n==null||n===undefined)return i;let t=n.length;if(t==0)return i;let r="The search string must be prefixed with 'cit_'";return t<4?r:n.substr(0,4)!="cit_"?r:t<6?"Please enter more than 5 characters":t>100?"Please enter less than 100 characters":null},forIpSearch=n=>{let t="Required field";if(n==null||n===undefined)return t;let i=n.length;if(i==0)return t;return/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(n)?null:"Type the correct IP address"};class SearchIp extends PageBase{constructor(){let n,t=window.location.href;t.lastIndexOf("#geoip")==-1&&(window.history.pushState(null,"GeoIp","?#geoip"),n=!1);t.lastIndexOf("?#geoip")!=-1&&(n=!1);n=!0;super("/ip/location?ip=","123.234.123.234","Type an IP address","GeoIp",forIpSearch,n)}}class SearchCity extends PageBase{constructor(){let n,t=window.location.href;t.lastIndexOf("#geocity")==-1&&(window.history.pushState(null,"GeoCity","?#geocity"),n=!1);t.lastIndexOf("?#geocity")!=-1&&(n=!1);n=!0;super("/city/locations?city=","cit_Gbqw4","Type a city name","GeoCity",forCitySearch,n)}}class StartServ{constructor(){this.btnSearchIp=$(".fromip");this.btnSearchCity=$(".fromcity");this.btnSearchIp.on("click",n=>this.BtnSearchIp_Click(n));this.btnSearchCity.on("click",n=>this.BtnSearchCity_Click(n));let n=window.location.href;n.lastIndexOf("#geocity")!=-1?this.btnSearchCity.click():this.btnSearchIp.click()}BtnSearchIp_Click(n){n.stopPropagation();let t=$(n.target);t.prop("disabled",!0);this.btnSearchCity.prop("disabled",!1);this.Worker=new SearchIp}BtnSearchCity_Click(n){n.stopPropagation();let t=$(n.target);t.prop("disabled",!0);this.btnSearchIp.prop("disabled",!1);this.Worker=new SearchCity}}